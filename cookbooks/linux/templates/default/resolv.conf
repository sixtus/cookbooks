<% node[:resolv][:nameservers].each do |ns| %>
nameserver <%= ns %>
<% end %>
<%
  search_domains = [node[:resolv][:search]]
  search_domains << node[:chef_domain] if node[:chef_domain]
  search_domains << "#{node.cluster_name}.#{node[:chef_domain]}" if node.clustered?
  search_domains = search_domains.flatten.compact

  if search_domains.length > 0
%>
search <%= search_domains.join(" ") %>
<% end %>
